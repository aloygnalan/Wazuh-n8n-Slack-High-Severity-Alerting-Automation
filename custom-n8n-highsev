#!/bin/bash
# ==========================================================
# Wrapper for custom-n8n-highsev.py
# Ensures Wazuh calls Python correctly
# ==========================================================

ALERT_FILE="$1"
USER="$2"
HOOK_URL="$3"

PYTHON_SCRIPT="/var/ossec/integrations/custom-n8n-highsev.py"
LOG_FILE="/var/ossec/logs/integrations.log"

# Ensure Python script exists
if [ ! -f "$PYTHON_SCRIPT" ]; then
  echo "[custom-n8n-highsev] Python script not found!" >> "$LOG_FILE"
  exit 1
fi

# Call the Python script exactly as Wazuh expects
/usr/bin/env python3 "$PYTHON_SCRIPT" "$ALERT_FILE" "$USER" "$HOOK_URL"

# Return exit status from Python script
exit $?

